#!/bin/sh
# $Id: check_paranoia.sh.in,v 1.5 2005/01/22 18:54:19 rocky Exp $
# Compare our cd-paranoia with an installed cdparanoia

if test "@CMP@" != no -a "@BUILD_CD_PARANOIA_TRUE@"X = X ; then
  ../src/cd-paranoia/cd-paranoia -d ./cdda.cue -v -r -- "1-"
  dd bs=16 skip=17 if=./cdda.raw of=./cdda-1.raw
  dd bs=16 if=./cdda.bin of=cdda-2.raw count=44377
  if @CMP@ ./cdda-1.raw ./cdda-2.raw ; then
    echo "** Raw cdda.bin extraction okay"
  else
    echo "** Raw cdda.bin extraction differ"
    exit 3
  fi
  mv cdda.raw cdda-good.raw
  ../src/cd-paranoia/cd-paranoia -d ./cdda.cue -x 64 -v -r -- "1-"
  mv cdda.raw cdda-underrun.raw
  ../src/cd-paranoia/cd-paranoia -d ./cdda.cue -r -- "1-"
  if @CMP@ ./cdda-underrun.raw ./cdda-good.raw ; then
    echo "** Under-run correction okay"
  else
    echo "** Under-run correction problem"
    exit 3
  fi
  ../src/cd-paranoia/cd-paranoia -d ./cdda.cue -x 5 -v -r -- "1-"
  mv cdda.raw cdda-jitter.raw
  if @CMP@ ./cdda-jitter.raw ./cdda-good.raw ; then
    echo "** Jitter correction okay"
  else
    echo "** Jitter correction problem"
    exit 3
  fi
  exit 0
else 
  echo "Don't see libcdio cd-paranoia program. Test skipped."
  exit 77
fi
fi
#;;; Local Variables: ***
#;;; mode:shell-script ***
#;;; eval: (sh-set-shell "bash") ***
#;;; End: ***

